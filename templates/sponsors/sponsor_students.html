{% extends "base.html" %}
{% block content %}
<h2>My Sponsored Students</h2>
<form method="get" style="margin:1rem 0">
  <select name="status">
    <option value="">Any status</option>
    <option value="ongoing" {% if request.GET.status == "ongoing" %}selected{% endif %}>Ongoing</option>
    <option value="completed" {% if request.GET.status == "completed" %}selected{% endif %}>Completed</option>
    <option value="dropped" {% if request.GET.status == "dropped" %}selected{% endif %}>Dropped</option>
  </select>
  <input type="number" step="0.01" min="0" max="100" name="min_progress" placeholder="Min progress %" value="{{ request.GET.min_progress }}" />
  <button type="submit">Filter</button>
</form>

<table>
  <thead><tr><th>Student</th><th>Course</th><th>Status</th><th>Progress %</th></tr></thead>
  <tbody>
    {% for e in page_obj.object_list %}
      <tr>
        <td>{{ e.student.get_full_name|default:e.student.username }}</td>
        <td>{{ e.course.title }}</td>
        <td>{{ e.get_status_display }}</td>
        <td>{{ e.progress }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="4">No records.</td></tr>
    {% endfor %}
  </tbody>
</table>

<div>
  {% if page_obj.has_previous %}<a href="?status={{ request.GET.status }}&min_progress={{ request.GET.min_progress }}&page={{ page_obj.previous_page_number }}">Prev</a>{% endif %}
  <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
  {% if page_obj.has_next %}<a href="?status={{ request.GET.status }}&min_progress={{ request.GET.min_progress }}&page={{ page_obj.next_page_number }}">Next</a>{% endif %}
</div>
{% endblock %}
